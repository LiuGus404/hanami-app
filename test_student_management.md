# 學生管理功能測試指南

## 測試環境準備

### 1. 資料庫設置檢查
確保已執行以下 SQL 腳本：
```sql
-- 檢查表是否存在
SELECT table_name FROM information_schema.tables 
WHERE table_schema = 'public' 
AND table_name = 'inactive_student_list';

-- 檢查 RLS 是否啟用
SELECT tablename, rowsecurity FROM pg_tables 
WHERE tablename = 'inactive_student_list';

-- 檢查策略是否創建
SELECT policyname, cmd, qual FROM pg_policies 
WHERE tablename = 'inactive_student_list';
```

### 2. 權限檢查
```sql
-- 檢查表權限
SELECT grantee, privilege_type 
FROM information_schema.role_table_grants 
WHERE table_name = 'inactive_student_list';
```

## 功能測試步驟

### 測試 1：停用學生功能

#### 步驟：
1. 登入管理員帳戶
2. 進入學生管理頁面
3. 選擇一個常規學生
4. 點擊"停用學生"按鈕
5. 確認操作

#### 預期結果：
- 學生從常規列表中消失
- 在"停用學生"篩選中可以看到該學生
- 學生顯示為灰色樣式

#### 檢查點：
- [ ] 學生成功移至停用列表
- [ ] 學生在常規篩選中不顯示
- [ ] 學生在停用篩選中顯示
- [ ] 學生顯示灰色樣式

### 測試 2：查看停用學生

#### 步驟：
1. 在篩選課程中選擇"停用學生"
2. 查看停用學生列表

#### 預期結果：
- 顯示所有停用的學生
- 學生以灰色樣式顯示
- 顯示停用日期信息

#### 檢查點：
- [ ] 停用學生正確顯示
- [ ] 灰色樣式正確應用
- [ ] 停用日期信息顯示
- [ ] 編輯按鈕不顯示

### 測試 3：點擊停用學生詳情

#### 步驟：
1. 在停用學生篩選中
2. 點擊停用學生的編輯圖標

#### 預期結果：
- 進入學生詳情頁面
- 顯示停用警告信息
- 學生資料正確顯示

#### 檢查點：
- [ ] 成功進入詳情頁面
- [ ] 顯示停用警告
- [ ] 學生資料完整顯示
- [ ] 編輯功能被禁用

### 測試 4：回復學生功能

#### 步驟：
1. 在停用學生篩選中選擇要回復的學生
2. 點擊"回復學生"按鈕
3. 確認操作

#### 預期結果：
- 學生從停用列表中消失
- 學生重新出現在常規列表中
- 學生恢復正常樣式

#### 檢查點：
- [ ] 學生成功從停用列表移除
- [ ] 學生重新出現在常規列表
- [ ] 學生恢復正常樣式
- [ ] 學生資料完整保留

## 錯誤處理測試

### 測試 5：權限錯誤處理

#### 步驟：
1. 嘗試在沒有權限的情況下操作
2. 檢查錯誤訊息

#### 預期結果：
- 顯示適當的錯誤訊息
- 操作被阻止

### 測試 6：資料完整性測試

#### 步驟：
1. 停用學生後檢查資料完整性
2. 回復學生後檢查資料完整性

#### 預期結果：
- 所有學生資料完整保留
- 沒有資料丟失

## 常見問題排查

### 問題 1：停用學生時出現錯誤
**可能原因：**
- 資料庫權限設置不正確
- RLS 策略配置錯誤
- 表結構不正確

**解決方案：**
1. 檢查資料庫權限
2. 重新執行 RLS 設置腳本
3. 確認表結構正確

### 問題 2：回復學生時出現錯誤
**可能原因：**
- 原始 ID 衝突
- 資料格式不正確
- 權限不足

**解決方案：**
1. 檢查原始 ID 是否已存在
2. 確認資料格式正確
3. 檢查用戶權限

### 問題 3：停用學生無法點擊詳情
**可能原因：**
- ID 映射錯誤
- 路由配置問題

**解決方案：**
1. 檢查 ID 映射邏輯
2. 確認路由配置正確

## 性能測試

### 測試 7：大量數據測試

#### 步驟：
1. 停用大量學生
2. 測試頁面載入性能
3. 測試篩選功能性能

#### 預期結果：
- 頁面載入時間合理
- 篩選功能響應迅速

## 安全測試

### 測試 8：權限安全測試

#### 步驟：
1. 使用不同權限的用戶測試
2. 嘗試越權操作

#### 預期結果：
- 只有管理員可以操作
- 越權操作被阻止

## 測試報告模板

### 測試結果記錄
```
測試日期：_________
測試人員：_________
測試環境：_________

功能測試結果：
□ 停用學生功能：通過/失敗
□ 查看停用學生：通過/失敗
□ 點擊停用學生詳情：通過/失敗
□ 回復學生功能：通過/失敗

錯誤處理測試結果：
□ 權限錯誤處理：通過/失敗
□ 資料完整性測試：通過/失敗

性能測試結果：
□ 大量數據測試：通過/失敗

安全測試結果：
□ 權限安全測試：通過/失敗

發現的問題：
1. ________________
2. ________________
3. ________________

建議改進：
1. ________________
2. ________________
3. ________________
```

## 聯繫支援

如果測試中發現問題，請：
1. 記錄詳細的錯誤訊息
2. 提供測試步驟和環境信息
3. 聯繫技術支援團隊

---
最後更新：2024-03-21 